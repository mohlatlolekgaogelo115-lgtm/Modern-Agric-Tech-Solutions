<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriCore | The Big Three (Full Functionality)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Modern Addition 1: PWA Manifest (self-contained data URI) -->
    <link rel="manifest" href="data:application/manifest+json,%7B%22name%22%3A%22AgriCore%20Precision%20Ag%22%2C%22short_name%22%3A%22AgriCore%22%2C%22start_url%22%3A%22.%22%2C%22display%22%3A%22standalone%22%2C%22theme_color%22%3A%22%232ECC71%22%2C%22background_color%22%3A%22%23F8F9FA%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22https%3A%2F%2Fpicsum.photos%2F192%2F192%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image%2Fpng%22%7D%2C%7B%22src%22%3A%22https%3A%2F%2Fpicsum.photos%2F512%2F512%22%2C%22sizes%22%3A%22512x512%22%2C%22type%22%3A%22image%2Fpng%22%7D%5D%7D">
    
    <style>
        :root {
            --soil-color: #8D6E63;
            --plant-color: #2ECC71;
            --water-color: #3498DB;
            --dark: #1A1A1A;
            --light: #F8F9FA;
            --text-gray: #4A4A4A;
            --footer-bg: #111111;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            scroll-behavior: smooth;
        }
        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        nav {
            background-color: var(--dark);
            color: var(--light);
            padding: 1rem 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        nav h1 span { color: var(--plant-color); }
        .nav-links a {
            color: var(--light);
            text-decoration: none;
            margin-left: 1.5rem;
            font-weight: 500;
        }
        header {
            background: linear-gradient(rgba(26, 26, 26, 0.85), rgba(26, 26, 26, 0.85)), url('https://images.unsplash.com/photo-1586771107445-d3af2e88258e?auto=format&fit=crop&w=1920&q=80') center/cover;
            color: var(--light);
            padding: 10rem 5%;
            text-align: center;
        }
        .cta-btn {
            background-color: var(--plant-color);
            color: var(--dark);
            padding: 1rem 2.5rem;
            text-decoration: none;
            font-weight: bold;
            border-radius: 30px;
            cursor: pointer;
            border: none;
            transition: 0.3s;
        }
        section { padding: 6rem 5%; }
        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
        }
        .reverse-grid { direction: rtl; }
        .reverse-grid > * { direction: ltr; }
        .module-badge {
            font-size: 1.2rem;
            padding: 0.3rem 1rem;
            border-radius: 20px;
            color: white;
            font-weight: bold;
        }
        .feature-box {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            margin-bottom: 1rem;
        }
        .visual-container {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            min-height: 450px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        #upload-zone {
            border: 2px dashed var(--plant-color);
            width: 100%;
            height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border-radius: 10px;
            transition: 0.3s;
        }
        #upload-zone:hover { background: #f0fff4; }
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        input:checked + .slider { background-color: var(--water-color); }
        /* PROFESSIONAL FOOTER STYLES */
        footer {
            background-color: var(--footer-bg);
            color: #e0e0e0;
            padding: 4rem 5% 2rem 5%;
            font-size: 0.9rem;
        }
        .footer-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 2fr;
            gap: 3rem;
            border-bottom: 1px solid #333;
            padding-bottom: 3rem;
        }
        .footer-brand h2 {
            color: white;
            margin-bottom: 1rem;
        }
        .footer-brand h2 span { color: var(--plant-color); }
        .footer-column h4 {
            color: white;
            margin-bottom: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.8rem;
        }
        .footer-column ul {
            list-style: none;
        }
        .footer-column ul li {
            margin-bottom: 0.8rem;
        }
        .footer-column ul li a {
            color: #aaa;
            text-decoration: none;
            transition: 0.3s;
        }
        .footer-column ul li a:hover {
            color: var(--plant-color);
        }
        .newsletter-form {
            display: flex;
            margin-top: 1rem;
        }
        .newsletter-form input {
            background: #222;
            border: 1px solid #444;
            padding: 0.8rem;
            color: white;
            border-radius: 5px 0 0 5px;
            flex: 1;
        }
        .newsletter-form button {
            background: var(--plant-color);
            border: none;
            padding: 0 1.2rem;
            border-radius: 0 5px 5px 0;
            cursor: pointer;
            font-weight: bold;
        }
        .footer-bottom {
            padding-top: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #666;
        }
        @media (max-width: 968px) {
            .footer-grid { grid-template-columns: 1fr 1fr; }
        }
        @media (max-width: 600px) {
            .footer-grid { grid-template-columns: 1fr; }
            .footer-bottom { flex-direction: column; gap: 1rem; text-align: center; }
        }

        /* New styles for modern additions (only added) */
        #chat-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--plant-color);
            color: #1A1A1A;
            border: none;
            width: 65px;
            height: 65px;
            border-radius: 50%;
            font-size: 28px;
            box-shadow: 0 10px 30px rgba(46, 204, 113, 0.4);
            z-index: 9999;
            cursor: pointer;
            transition: all 0.3s;
        }
        #chat-btn:hover { transform: scale(1.1); }
        #chat-modal {
            display: none;
            position: fixed;
            bottom: 110px;
            right: 30px;
            width: 360px;
            background: white;
            border-radius: 18px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.25);
            z-index: 10000;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <nav>
        <h1>Agri<span>Core</span></h1>
        <div class="nav-links">
            <a href="#layer-a">Soil</a>
            <a href="#layer-b">Plant Health</a>
            <a href="#layer-c">Water</a>
        </div>
    </nav>
    <header>
        <h2>The Core of Precision Ag.</h2>
        <p>A integrating Soil Intelligence, Plant Agronomy, and Water Management.</p>
        <button class="cta-btn" onclick="location.href='#layer-a'">Initialize Dashboard</button>
    </header>
    <section id="layer-a">
        <div class="grid-container">
            <div>
                <h3 style="color: var(--soil-color);">
                    <span class="module-badge" style="background-color: var(--soil-color);">Layer A</span>
                    Soil Intelligence
                </h3>
                <div class="feature-box" style="border-left: 5px solid var(--soil-color);">
                    <h4>Dynamic Nutrient Mapping</h4>
                    <p>Real-time heatmaps of Nitrogen ($N$), Phosphorus ($P$), and Potassium ($K$) across your acreage.</p>
                </div>
                <div class="feature-box" style="border-left: 5px solid var(--soil-color);">
                    <h4>Predictive Mineralization AI</h4>
                    <p>Current Soil Temp: <b>22.5Â°C</b> | AI Status: <b>Predicting Nutrient Release...</b></p>
                </div>
            </div>
            <div class="visual-container">
                <h4 style="margin-bottom: 1rem;">Live GIS Nutrient Profile</h4>
                <canvas id="soilChart" aria-label="Live GIS Nutrient Profile radar chart showing Nitrogen, Phosphorus, Potassium, Magnesium, Sulfur"></canvas>
            </div>
        </div>
    </section>
    <section id="layer-b" style="background-color: white;">
        <div class="grid-container reverse-grid">
            <div>
                <h3 style="color: var(--plant-color);">
                    <span class="module-badge" style="background-color: var(--plant-color);">Layer B</span>
                    Plant Health & Agronomy
                </h3>
                <div class="feature-box" style="border-left: 5px solid var(--plant-color);">
                    <h4>GenAI Virtual Agronomist</h4>
                    <div id="upload-zone" role="button" tabindex="0" aria-label="Upload leaf photo for AI analysis" onclick="document.getElementById('leaf-upload').click()">
                        <p id="upload-text">Drag & Drop Leaf Photo Here</p>
                        <input type="file" id="leaf-upload" style="display:none" onchange="handleAIAnalysis()">
                    </div>
                </div>
                <div class="feature-box" style="border-left: 5px solid var(--plant-color);">
                    <h4>VRT Export Engine</h4>
                    <button class="cta-btn" style="width: 100%;" onclick="exportVRT()">Download Tractor Shapefiles (.SHP)</button>
                </div>
            </div>
            <div class="visual-container">
                <h4 style="margin-bottom: 1rem;">Satellite Spectral Index (NDVI)</h4>
                <canvas id="ndviChart" aria-label="Satellite Spectral Index (NDVI) line chart"></canvas>
            </div>
        </div>
    </section>
    <section id="layer-c">
        <div class="grid-container">
            <div>
                <h3 style="color: var(--water-color);">
                    <span class="module-badge" style="background-color: var(--water-color);">Layer C</span>
                    Water & Irrigation
                </h3>
                <div class="feature-box" style="border-left: 5px solid var(--water-color);">
                    <h4>AI-Guided Irrigation</h4>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <p>Smart-Pump Automation:</p>
                        <label class="switch">
                            <input type="checkbox" id="pumpSwitch" onchange="togglePump()">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <p id="pump-status" style="margin-top: 10px; font-weight: bold; color: var(--text-gray);">Status: Offline</p>
                </div>
                <div class="feature-box" style="border-left: 5px solid var(--water-color);">
                    <h4>Water Quality Index</h4>
                    <p>Salinity: <span style="color: green;">Normal</span> | Runoff Risk: <span style="color: orange;">Moderate</span></p>
                </div>
            </div>
            <div class="visual-container">
                <h4 style="margin-bottom: 1rem;">Soil Moisture vs. Evapotranspiration</h4>
                <canvas id="waterChart" aria-label="Soil Moisture vs. Evapotranspiration bar chart"></canvas>
            </div>
        </div>
    </section>

    <!-- Modern Addition 5: Sustainability Metrics Dashboard (Layer D) -->
    <section id="layer-d" style="background-color: #f8fff9;">
        <div class="grid-container">
            <div>
                <h3 style="color: #27AE60;">
                    <span class="module-badge" style="background-color: #27AE60;">Layer D</span>
                    Sustainability Intelligence
                </h3>
                <div class="feature-box" style="border-left: 5px solid #27AE60;">
                    <h4>Carbon Footprint Tracker</h4>
                    <p>Estimated Carbon Sequestration: <b>15.2 tCOâ‚‚/ha</b> (+12% YoY)</p>
                </div>
            </div>
            <div class="visual-container">
                <h4 style="margin-bottom: 1rem;">Farm Carbon Balance</h4>
                <canvas id="carbonChart"></canvas>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-grid">
            <div class="footer-brand">
                <h2>Agri<span>Core</span></h2>
                <p>Leading the 2026 agricultural revolution through precision data, spectral intelligence, and autonomous resource management.</p>
                <div class="newsletter-form">
                    <input type="email" placeholder="Farmer email updates...">
                    <button>Join</button>
                </div>
            </div>
            <div class="footer-column">
                <h4>Platform</h4>
                <ul>
                    <li><a href="#layer-a">Soil Mapping</a></li>
                    <li><a href="#layer-b">Spectral NDVI</a></li>
                    <li><a href="#layer-c">Water Control</a></li>
                    <li><a href="#">VRT Export</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Support</h4>
                <ul>
                    <li><a href="#">Documentation</a></li>
                    <li><a href="#">API Reference</a></li>
                    <li><a href="#">Sensor Setup</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Contact</h4>
                <ul>
                    <li>Email: contact@agricore.tech</li>
                    <li>Phone: +1 (555) AGRI-DATA</li>
                    <li>HQ: 1200 Innovation Way, Silicon Prairie</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 AgriCore Precision Systems. All Rights Reserved.</p>
            <p>Status: All Systems Operational</p>
        </div>
    </footer>

    <!-- Modern Addition 4: AI-Powered Chatbot (floating button + modal) -->
    <button id="chat-btn" onclick="toggleChat()">ðŸŒ±</button>

    <div id="chat-modal">
        <div style="background: var(--plant-color); color: #1A1A1A; padding: 16px 20px; font-weight: 600; display: flex; justify-content: space-between; align-items: center;">
            <span>ðŸŒ± AgriCore AI Assistant</span>
            <span onclick="toggleChat()" style="cursor:pointer; font-size: 22px;">Ã—</span>
        </div>
        <div id="chat-body" style="height: 340px; padding: 20px; overflow-y: auto; background: #fafafa;">
            <p><strong>Welcome!</strong> Ask me anything about your farm â€” soil pH, pest alerts, irrigation schedules, or carbon goals.</p>
        </div>
        <div style="padding: 12px; border-top: 1px solid #eee; display: flex;">
            <input type="text" id="chat-input" placeholder="Type your question..." 
                   style="flex:1; padding:12px; border:1px solid #ddd; border-radius:8px 0 0 8px;" 
                   onkeypress="if(event.key==='Enter') sendChatMessage()">
            <button onclick="sendChatMessage()" style="background:var(--plant-color); color:#1A1A1A; border:none; padding:0 18px; border-radius:0 8px 8px 0; font-weight:bold;">Send</button>
        </div>
    </div>

    <script>
        // === ORIGINAL JAVASCRIPT (100% unchanged) ===
        const ctxSoil = document.getElementById('soilChart').getContext('2d');
        new Chart(ctxSoil, {
            type: 'radar',
            data: {
                labels: ['Nitrogen', 'Phosphorus', 'Potassium', 'Magnesium', 'Sulfur'],
                datasets: [{
                    label: 'Field Sector 01',
                    data: [85, 60, 90, 45, 70],
                    backgroundColor: 'rgba(141, 110, 99, 0.4)',
                    borderColor: '#8D6E63'
                }]
            }
        });
        const ctxNDVI = document.getElementById('ndviChart').getContext('2d');
        new Chart(ctxNDVI, {
            type: 'line',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                datasets: [{
                    label: 'NDVI Score',
                    data: [0.4, 0.65, 0.82, 0.78],
                    borderColor: '#2ECC71',
                    fill: true,
                    backgroundColor: 'rgba(46, 204, 113, 0.1)'
                }]
            }
        });
        const ctxWater = document.getElementById('waterChart').getContext('2d');
        new Chart(ctxWater, {
            type: 'bar',
            data: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'],
                datasets: [{
                    label: 'Soil Moisture %',
                    data: [45, 42, 38, 55, 52],
                    backgroundColor: '#3498DB'
                }]
            }
        });
        function handleAIAnalysis() {
            const text = document.getElementById('upload-text');
            text.innerHTML = "<b>Analyzing Image...</b>";
            setTimeout(() => {
                text.innerHTML = "<b>Result:</b> Target identified. Suggesting Bio-Pesticide: Neem Extract.";
                text.style.color = "var(--plant-color)";
            }, 2000);
        }
        function exportVRT() {
            alert("Generating VRT prescription files. Download starting...");
        }
        function togglePump() {
            const status = document.getElementById('pump-status');
            const isChecked = document.getElementById('pumpSwitch').checked;
            status.innerText = isChecked ? "Status: AI Optimized (Pumping Active)" : "Status: Offline";
            status.style.color = isChecked ? "var(--water-color)" : "var(--text-gray)";
        }

        // === NEW MODERN ADDITIONS ===

        // Modern Addition 2: Accessibility keyboard support for upload zone
        document.getElementById('upload-zone').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                document.getElementById('leaf-upload').click();
            }
        });

        // Modern Addition 3: Web Vitals / Lazy Loading with Intersection Observer
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                }
            });
        }, { threshold: 0.3 });

        document.querySelectorAll('canvas').forEach(canvas => {
            canvas.style.opacity = '0.3';
            observer.observe(canvas);
        });

        // Modern Addition 5: Sustainability Carbon Chart
        const ctxCarbon = document.getElementById('carbonChart').getContext('2d');
        new Chart(ctxCarbon, {
            type: 'doughnut',
            data: {
                labels: ['Sequestered', 'Emitted'],
                datasets: [{
                    data: [68, 32],
                    backgroundColor: ['#27AE60', '#E74C3C'],
                    borderColor: '#fff',
                    borderWidth: 4
                }]
            },
            options: { responsive: true, plugins: { legend: { position: 'bottom' } } }
        });

        // Modern Addition 4: AI Chatbot
        function toggleChat() {
            const modal = document.getElementById('chat-modal');
            modal.style.display = modal.style.display === 'block' ? 'none' : 'block';
        }
        function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const body = document.getElementById('chat-body');
            if (!input.value.trim()) return;
            
            body.innerHTML += `<p style="text-align:right;color:var(--plant-color);margin:8px 0;"><strong>You:</strong> ${input.value}</p>`;
            
            const question = input.value.toLowerCase();
            setTimeout(() => {
                let reply = "Great question! ";
                if (question.includes('ph') || question.includes('soil')) reply += "Your average soil pH is 6.4 â€” perfect range for maize.";
                else if (question.includes('pest') || question.includes('disease')) reply += "NDVI shows early stress in Sector B2. Recommend scouting for aphids.";
                else if (question.includes('irrigation') || question.includes('water')) reply += "AI suggests 38 minutes tonight at 60% capacity.";
                else reply += "Based on your latest data, I recommend adjusting nitrogen by +8 kg/ha this week.";
                body.innerHTML += `<p style="margin:8px 0;"><strong>AgriCore AI:</strong> ${reply}</p>`;
                body.scrollTop = body.scrollHeight;
            }, 650);
            
            input.value = '';
            body.scrollTop = body.scrollHeight;
        }

        // Modern Addition 1: PWA Service Worker (fully inline, self-contained)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                const swCode = `
                    const CACHE = 'agricore-cache-v1';
                    self.addEventListener('install', e => {
                        e.waitUntil(
                            caches.open(CACHE).then(cache => cache.addAll(['/','index.html']))
                        );
                    });
                    self.addEventListener('fetch', e => {
                        e.respondWith(
                            caches.match(e.request).then(response => response || fetch(e.request))
                        );
                    });
                `;
                const blob = new Blob([swCode], {type: 'application/javascript'});
                const swUrl = URL.createObjectURL(blob);
                navigator.serviceWorker.register(swUrl)
                    .then(() => console.log('%cAgriCore PWA ready for offline use', 'color:#2ECC71;font-weight:bold'))
                    .catch(err => console.log('PWA SW error', err));
            });
        }
    </script>
</body>
</html>
